<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ESP32 OTA Update via BLE</title>
</head>
<body>
  <h1>ESP32 OTA Update via BLE</h1>
  <input type="file" id="fileInput" accept=".bin"><br>
  <button onclick="sendOTA()">Send OTA Update</button>

  <script>
    async function sendOTA() {
      const fileInput = document.getElementById('fileInput');
      const file = fileInput.files[0];
      
      if (!file) {
        alert('Please select a firmware file');
        return;
      }

      try {
        const device = await navigator.bluetooth.requestDevice({
          filters: [{
            name: 'OTA_ESP32' // Change to match the name of your ESP32 BLE device
          }],
          optionalServices: ['4fafc201-1fb5-459e-8fcc-c5c9c331914b'] // Change to match the service UUID of your ESP32 BLE service
        });

        const server = await device.gatt.connect();
        const service = await server.getPrimaryService('4fafc201-1fb5-459e-8fcc-c5c9c331914b'); // Change to match the service UUID of your ESP32 BLE service
        const characteristic = await service.getCharacteristic('beb5483e-36e1-4688-b7f5-ea07361b26a8'); // Change to match the RX characteristic UUID of your ESP32 BLE service

        const firmware = await file.arrayBuffer();
        await characteristic.writeValue(firmware);

        alert('OTA Update sent successfully');
      } catch (error) {
        console.error('Error:', error);
        alert('Failed to send OTA Update');
      }
    }
  </script>
</body>
</html>
